# Elements

An element is a description of something attestable.

The element consists of a set of its identifier, the compulsory description and a set of optional structures.


## Compulsory Fields

The compulsory fields are described below. The field *itemid* is generated by Jane and is a UUID4; this field should not be specified when adding a new element.

| Field | Type | Description |
| --- | --- | --- |
| itemid | UUID4 | Internally generated identifier |
| name | String | A short name for the element |
| description | String | A longer, more descripive description |
| endpoint | String | Usually a URL pointing to the interface where attestation requests can be made |
| protocol | PROTOCOL | The name of the attestation protocol that the endpoint understands |
| tags | String List | A set of freeform tags used for classification |


## Optional Fields
There are a number of individual structures to describe particular properties, eg: of TPMs, UEFI records etc.  Not all combinations are valid together, but this very much depends  upon the nature of the element in question.

### Host Machine
In following fields are part of the *hostmachine* entry

| Field | Type | Description |
| --- | --- | --- |
| os | String | The operating system of the host machine |
| arch | String | The CPU architecture of the host machine |
| hostname | String | The hostname |

### SSHKEY
In following fields are part of the *sshkey* entry

| Field | Type | Description |
| --- | --- | --- |
| key | String | The location of the private SSH key |
| timeout | Integer | The connection timeout limit in seconds |
| username | String | The username to log into the given account |

### UEFI
In following fields are part of the *uefi* entry

| Field | Type | Description |
| --- | --- | --- |
| eventlog | String | The location of the UEFI eventlog |

Note: the location specified here may be overridden by the behaviour of the trust agent

### Linux IMA
In following fields are part of the *ima* entry

| Field | Type | Description |
| --- | --- | --- |
| asciilog | String | The location of the Linux IMA log |

Note: the location specified here may be overridden by the behaviour of the trust agent


### Intel TXT
In following fields are part of the *txt* entry

| Field | Type | Description |
| --- | --- | --- |
| log | String | The location of the Intel TXT log |

Note: the location specified here may be overridden by the behaviour of the trust agent


### TPM 2.0
In following fields are part of the *tpm2* entry

| Field | Type | Description |
| --- | --- | --- |
| device | String | The location of the TPM2.0 device, eg: `/dev/tpmrm0` |
| ekcerthandle | String | The handle of the EK Certificate in the TPM NVRAM |
| ek | TPMKey | The structure describing the TPM 2.0 Endorsement Key |
| ak | TPMKey | The structure describing an attestation key |

The *TPMKey* structure is defined:

| Field | Type | Description |
| --- | --- | --- |
| handle | String | The handle of the key in the TPM` |
| public | String | The public part of the key - typically in PEM format |

### MarbleRun
In following fields are part of the *mrcoordinator* entry

| Field | Type | Description |
| --- | --- | --- |
| certs | String List | The MarbleRun coordinator certificates |

In following fields are part of the *mrmarbleinstance* entry

| Field | Type | Description |
| --- | --- | --- |
| expectednonce | String  | TBD |
| requestdata | String  | TBD |
| requestsignature | String  | TBD |

## Go Definition

The definition of the element structure can be found at https://github.com/iolivergithub/jane/blob/main/janeserver/structures/elements.go

## Example

```json
{ "itemid" : "57c5a486-64ce-4563-b281-a743429c1617", 
  "name" : "Test System", 
  "description" : "This is a test system", 
  "protocol" : "A10HTTPRESTv2", 
  "endpoint" : "http://192.168.1.19:8530", 
  "tags" : [ "pi", "linux", "medical" ], 
  "tpm2" : { "device" : "/dev/tpmrm0", 
  	"ek" : { "handle" : "0x810100EE", 
  		"public" : "8466ff8d2390c53f7e4297512f40a10465fb30c11a2a7d82e2cf592045b4eabf4a9a61ddabd931664a2e73f8c6afec9a05df146de32f0705d410c7881a33140e5b67aef2a8bf9236c718aaa3c23eea69ca89365350370dc9868bbb5a0262f90f865af1318cbb12f5ef4d87500b7090c475d1b5d72943796d95b902411168858e59da3827302cb7339aa4488a2d525d3e9eed86c8b09bddf6ea40a5f722f1903c39acf794e6c3ff67d6372f8f1c571f6c83d4c739c334d11cff98aac6751a158eca6ec22a996748855a1ffe7a60f5cc40a7c187bf6ce9944dcf943393b26a1e721d0d2a0f275de67bce63e591a823872d3ba436987ae2f7e3ea126f4dab24776d", 
  	    "name" : "000bd126c6e196401afcd92aa30072fa11204e705059122dbbb21480c6cab4afc473" },
   "ak" : { "handle" : "0x810100AA", 
       "public" : "a104e0972158670651d901de333cb05990443e8088daa1cd1b52c274c23c83d637bbb95427da10c5ebe62a96da4570486d1bdd38563942f6fca15cd2890aed9018d0becc5231fe5139a18cd8d21e3844ec339da07729fa2615ad1ed542a3167a3696c4173e710a0346bf3d457034ce8cd861a21578fe07d407aee421275e06aed3840004042f99899392ac6ea17314c52839cd92ee37773a8bb6b3dc4d42e032c224a965561d555cd2b3f7ccfc7504eb2ba67dabd094e0c7633d7d9bdcab26f03859efaa0451e38213f2d173fdb8c8e03b24e934b74c5c114e64207fcea104e0972158670651d901de333cb05990443e8088daa1cd1b52c274c23c83d637bbb95427da10c5ebe62a96da4570486d1bdd38563942f6fca15cd2890aed9018d0becc5231fe5139a18cd8d21e3844ec339da07729fa2615ad1ed542a3167a3696c4173e710a0346bf3d457034ce8cd861a21578fe07d407aee421275e06aed3840004042f99899392ac6ea17314c52839cd92ee37773a8bb6b3dc4d42e032c224a965561d555cd2b3f7ccfc7504eb2ba67dabd094e0c7633d7d9bdcab26f03859efaa0451e38213f2d173fdb8c8e03b24e934b74c5c114e64207fce952082a32534a8900083150a617fa1bd4793a33d83aa3668983e8001f852aa353c12cb", 
       "name" : "000bbaff812d583ae10504643d252fb051ac9b6203d4d59be83d8514c9f55a93f61d" } 
      }, 
     "host" : { "os" : "linux", "arch" : "arm", "hostname" : "testsys" }
 }
```